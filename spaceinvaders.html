<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <title>Space Invaders</title>
        <style>
            h1 {
                align-items: center;
            }
            .container {
                width: 100%;
                display: flex;
                flex-direction: row;
                align-items: center;
            }
            .rules {
                margin-right: 50px;
            }
            .game-container {
                display: flex;
                flex-direction: column;
                align-items: center;
            }

            .col {
                display: inline-block;
                width: 50px;
                height: 50px;
                border: 1px solid black;
            }

            .monster {
                background-image: url("spaceinvader.gif");
                background-repeat: none;
                background-position: center;
                background-size: 50px 50px;
            }

            .shot {
                background-color: red;
            }

            .character {
                background-color: green;
            }
        </style>
    </head>

    <body>
        <h1>Space Invaders</h1>
        <div class="container">
            <div class="rules">
                <h3>Points: <span id="point-counter">0</span></h3>
                <h3>Press Left and Right Arrow to Move</h3>
                <h3>Press Space to Fire</h3>
                <h3>If the monsters reach the bottom row, you lose!</h3>
            </div>
            <div class="game-container">
                <div class="row">
                    <div id="one-one" class="col"></div>
                    <div id="two-one" class="col"></div>
                    <div id="three-one" class="col"></div>
                    <div id="four-one" class="col"></div>
                    <div id="five-one" class="col"></div>
                    <div id="six-one" class="col"></div>
                    <div id="seven-one" class="col"></div>
                    <div id="eight-one" class="col"></div>
                    <div id="nine-one" class="col"></div>
                    <div id="ten-one" class="col"></div>
                </div>
                <div class="row">
                    <div id="one-two" class="col"></div>
                    <div id="two-two" class="col"></div>
                    <div id="three-two" class="col"></div>
                    <div id="four-two" class="col"></div>
                    <div id="five-two" class="col"></div>
                    <div id="six-two" class="col"></div>
                    <div id="seven-two" class="col"></div>
                    <div id="eight-two" class="col"></div>
                    <div id="nine-two" class="col"></div>
                    <div id="ten-two" class="col"></div>
                </div>
                <div class="row">
                    <div id="one-three" class="col"></div>
                    <div id="two-three" class="col"></div>
                    <div id="three-three" class="col"></div>
                    <div id="four-three" class="col"></div>
                    <div id="five-three" class="col"></div>
                    <div id="six-three" class="col"></div>
                    <div id="seven-three" class="col"></div>
                    <div id="eight-three" class="col"></div>
                    <div id="nine-three" class="col"></div>
                    <div id="ten-three" class="col"></div>
                </div>
                <div class="row">
                    <div id="one-four" class="col"></div>
                    <div id="two-four" class="col"></div>
                    <div id="three-four" class="col"></div>
                    <div id="four-four" class="col"></div>
                    <div id="five-four" class="col"></div>
                    <div id="six-four" class="col"></div>
                    <div id="seven-four" class="col"></div>
                    <div id="eight-four" class="col"></div>
                    <div id="nine-four" class="col"></div>
                    <div id="ten-four" class="col"></div>
                </div>
                <div class="row">
                    <div id="one-five" class="col"></div>
                    <div id="two-five" class="col"></div>
                    <div id="three-five" class="col"></div>
                    <div id="four-five" class="col"></div>
                    <div id="five-five" class="col"></div>
                    <div id="six-five" class="col"></div>
                    <div id="seven-five" class="col"></div>
                    <div id="eight-five" class="col"></div>
                    <div id="nine-five" class="col"></div>
                    <div id="ten-five" class="col"></div>
                </div>
                <div class="row">
                    <div id="one-six" class="col"></div>
                    <div id="two-six" class="col"></div>
                    <div id="three-six" class="col"></div>
                    <div id="four-six" class="col"></div>
                    <div id="five-six" class="col"></div>
                    <div id="six-six" class="col"></div>
                    <div id="seven-six" class="col"></div>
                    <div id="eight-six" class="col"></div>
                    <div id="nine-six" class="col"></div>
                    <div id="ten-six" class="col"></div>
                </div>
                <div class="row">
                    <div id="one-seven" class="col"></div>
                    <div id="two-seven" class="col"></div>
                    <div id="three-seven" class="col"></div>
                    <div id="four-seven" class="col"></div>
                    <div id="five-seven" class="col"></div>
                    <div id="six-seven" class="col"></div>
                    <div id="seven-seven" class="col"></div>
                    <div id="eight-seven" class="col"></div>
                    <div id="nine-seven" class="col"></div>
                    <div id="ten-seven" class="col"></div>
                </div>
                <div class="row">
                    <div id="one-eight" class="col"></div>
                    <div id="two-eight" class="col"></div>
                    <div id="three-eight" class="col"></div>
                    <div id="four-eight" class="col"></div>
                    <div id="five-eight" class="col"></div>
                    <div id="six-eight" class="col"></div>
                    <div id="seven-eight" class="col"></div>
                    <div id="eight-eight" class="col"></div>
                    <div id="nine-eight" class="col"></div>
                    <div id="ten-eight" class="col"></div>
                </div>
                <div class="row">
                    <div id="one-nine" class="col"></div>
                    <div id="two-nine" class="col"></div>
                    <div id="three-nine" class="col"></div>
                    <div id="four-nine" class="col"></div>
                    <div id="five-nine" class="col"></div>
                    <div id="six-nine" class="col"></div>
                    <div id="seven-nine" class="col"></div>
                    <div id="eight-nine" class="col"></div>
                    <div id="nine-nine" class="col"></div>
                    <div id="ten-nine" class="col"></div>
                </div>
                <div class="row">
                    <div id="one-ten" class="col"></div>
                    <div id="two-ten" class="col"></div>
                    <div id="three-ten" class="col"></div>
                    <div id="four-ten" class="col"></div>
                    <div id="five-ten" class="col"></div>
                    <div id="six-ten" class="col character"></div>
                    <div id="seven-ten" class="col"></div>
                    <div id="eight-ten" class="col"></div>
                    <div id="nine-ten" class="col"></div>
                    <div id="ten-ten" class="col"></div>
                </div>
            </div>
        </div>
        <script>
            var points = 0;
            var canvas = [[0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 1, 0, 0, 0, 0]]
            var grid = ["one", "two", "three", "four", "five", "six", "seven", "eight", "nine", "ten"];
            var count = true;
            for (var i = 0; i < 3; i++) {
                for (var j = 0; j < 10; j++) {
                    if (count) {
                        canvas[i][j] = 2;
                        document.getElementById(grid[j] + "-" + grid[i]).setAttribute("class", "col monster");
                    }
                    count = !count;
                }
                count = !count;
            }
            document.onkeydown = (event) => {
                switch (event.keyCode) {
                    case 37:
                        //left
                        for (var i = 1; i < 10; i++) {
                            if (canvas[9][i] === 1) {
                                canvas[9][i] = 0;
                                canvas[9][i - 1] = 1;
                                document.getElementById(grid[i] + "-ten").setAttribute("class", "col");
                                document.getElementById(grid[i - 1] + "-ten").setAttribute("class", "col character");
                                break;
                            }
                        }
                        break;
                    case 39:
                        //right
                        for (var i = 0; i < 9; i++) {
                            if (canvas[9][i] === 1) {
                                canvas[9][i + 1] = 1;
                                canvas[9][i] = 0;
                                document.getElementById(grid[i + 1] + "-ten").setAttribute("class", "col character");
                                document.getElementById(grid[i] + "-ten").setAttribute("class", "col");
                                break;
                            }
                        }
                        break;
                    case 32:
                        //space
                        let character;
                        for (var i = 0; i < 10; i++) {
                            if (canvas[9][i] === 1) {
                                character = i;
                            }
                        }
                        let origin = 8;
                        let shot = setInterval(() => {
                            if (origin === -1) {
                                document.getElementById(grid[character] + "-" + grid[0]).setAttribute("class", "col");
                                clearInterval(shot);
                            }
                            else{
                                if (canvas[origin][character] === 2) {
                                    canvas[origin][character] = 0;
                                    canvas[origin + 1][character] = 0;
                                    document.getElementById(grid[character] + "-" + grid[origin]).setAttribute("class", "col");
                                    document.getElementById(grid[character] + "-" + grid[origin + 1]).setAttribute("class", "col");
                                    points += 10;
                                    document.getElementById("point-counter").innerText = points;
                                    clearInterval(shot);
                                }
                                else {
                                    canvas[origin][character] = 3;
                                    document.getElementById(grid[character] + "-" + grid[origin]).setAttribute("class", "col shot");
                                    if (canvas[origin + 1][character] === 3) {
                                        canvas[origin + 1][character] = 0;
                                        document.getElementById(grid[character] + "-" + grid[origin + 1]).setAttribute("class", "col");
                                    }
                                }
                                origin--;
                            }
                        }, 200)
                }
            }
            var time = setInterval(() => {
                for (var i = 8; i >= 0; i--) {
                    for (var j = 0; j < 10; j++) {
                        if (canvas[i][j] === 2) {
                            canvas[i][j] = 0;
                            document.getElementById(grid[j] + "-" + grid[i]).setAttribute("class", "col");
                            document.getElementById(grid[j] + "-" + grid[i + 1]).setAttribute("class", "col monster");
                            canvas[i + 1][j] = 2;
                        }
                    }
                }
                if (canvas[9].includes(2)) {
                    alert("You lose");
                    clearInterval(time);
                }
                console.log(canvas.every(x => !x.includes(2)));
                if(canvas.every(x => !x.includes(2))) {    
                    for (var i = 0; i < 3; i++) {
                        for (var j = 0; j < 10; j++) {
                            if (count) {
                                canvas[i][j] = 2;
                                document.getElementById(grid[j] + "-" + grid[i]).setAttribute("class", "col monster");
                            }
                            count = !count;
                        }
                        count = !count;
                    }
                }
            }, 5000);

        </script>
    </body>

</html>